import{C as S,D as T,E as U,u as z,l as p,d as F,o as c,c as u,n as E,a as e,j as k,t as i,k as R,x as w,_ as P,F as B,s as j,b as I,f as q,y as H,e as h,g as Y,B as V,q as W}from"./index-Cwji7ajR.js";async function K(t){return(await S(`${T.inventory}/balance/particles`,{token:t})).balance}async function G(t,l){return(await S(`${T.inventory}/balance/token/${l}`,{token:t})).balance}async function Q(t,l){return S(`${T.equipment}/inventory`,{method:"POST",token:t,body:l})}async function X(t,l){return S(`${T.equipment}/enhance`,{method:"POST",token:t,body:{equipmentId:l}})}async function J(t,l){return S(`${T.equipment}/enhance/cost`,{method:"POST",token:t,body:{equipmentId:l}})}async function Z(t,l){return{particles:(await S(`${T.equipment}/salvage`,{method:"POST",token:t,body:{equipmentId:l}})).length}}async function ee(t,l,n){return S(`${T.equipment}/${l}/favorite`,{method:n?"POST":"DELETE",token:t})}const te=U("inventory",()=>{const t=z(),l=p(0),n=p(0),N=p(0),f=p(0),v=p(0),a=p([]),o=p(0),g=p(!1),m=p(null);async function r(){if(t.token)try{const[x,d,b,C,y]=await Promise.all([K(t.token),G(t.token,"common"),G(t.token,"rare"),G(t.token,"fabled"),G(t.token,"mythic")]);l.value=x,n.value=d,N.value=b,f.value=C,v.value=y}catch(x){console.error("Failed to fetch balances",x)}}async function O(x=1,d=20,b,C){if(t.token){g.value=!0,m.value=null;try{const y=await Q(t.token,{page:x,pageSize:d,filter:b,sort:C});a.value=y.items,o.value=y.totalCount}catch(y){m.value=y.message||"Failed to fetch inventory"}finally{g.value=!1}}}async function $(x){if(t.token)try{const d=await X(t.token,x),b=a.value.findIndex(C=>C.id===x);return b!==-1&&(a.value[b]=d),await r(),d}catch(d){throw d}}async function L(x){if(t.token)try{const d=await Z(t.token,x);return a.value=a.value.filter(b=>b.id!==x),o.value--,await r(),d}catch(d){throw d}}async function A(x,d){if(t.token)try{await ee(t.token,x,d);const b=a.value.find(C=>C.id===x);b&&(b.isFavorite=d)}catch(b){console.error("Failed to toggle favorite",b)}}return{particles:l,commonTokens:n,rareTokens:N,fabledTokens:f,mythicTokens:v,equipment:a,totalEquipment:o,isLoading:g,error:m,fetchBalances:r,fetchInventory:O,enhanceItem:$,salvageItem:L,toggleFavorite:A}}),se={key:0,class:"absolute -top-1 -right-1 z-20 text-yellow-400 drop-shadow-md"},ae={class:"flex flex-col items-center justify-center p-3 relative z-10 h-full"},ne=["src","alt"],le={key:0,class:"absolute -top-2 -right-2 bg-indigo-600 text-white text-[10px] font-bold px-1.5 py-0.5 border border-indigo-400 shadow-sm"},oe={class:"text-[10px] text-slate-400 font-bold uppercase tracking-tighter"},ie={class:"item-tooltip pixel-box-iron"},re={class:"flex justify-between items-center mb-1"},ce={class:"text-xs font-bold"},de={class:"text-[10px] text-white/60"},ue={key:0,class:"enhance-text"},pe={class:"tooltip-stats"},ve={class:"stat-row"},me={class:"value text-amber-400"},xe={class:"tooltip-actions"},ge=F({__name:"EquipmentCard",props:{item:{}},emits:["enhance","salvage","toggle-favorite"],setup(t){const l=t,n=w(()=>{const m=l.item.type.toLowerCase();return m.includes("wpn")?"https://vibemedia.space/wpn_steel_sword_123.png?prompt=pixel%20steel%20sword%20sprite&style=pixel_game_asset&key=NOGON":m.includes("ring")?"https://vibemedia.space/ring_gold_456.png?prompt=pixel%20gold%20ring%20sprite&style=pixel_game_asset&key=NOGON":"https://vibemedia.space/item_generic_789.png?prompt=pixel%20mystery%20item%20sprite&style=pixel_game_asset&key=NOGON"}),N=w(()=>l.item.level*10+l.item.rarity*25+l.item.enhancement*15),f={0:{name:"BASIC",border:"border-slate-800",icon:"bg-slate-900 border-slate-700"},1:{name:"COMMON",border:"border-slate-700",icon:"bg-slate-800 border-slate-700"},2:{name:"RARE",border:"border-blue-900",icon:"bg-blue-900/40 border-blue-700"},3:{name:"FABLED",border:"border-purple-900",icon:"bg-purple-900/40 border-purple-700"},4:{name:"MYTHIC",border:"border-amber-900",icon:"bg-amber-900/40 border-amber-700"},5:{name:"LEGENDARY",border:"border-red-900",icon:"bg-red-900/40 border-red-700"}},v=w(()=>f[l.item.rarity]||f[0]),a=w(()=>v.value.name),o=w(()=>v.value.border),g=w(()=>v.value.icon);return(m,r)=>(c(),u("div",{class:E(["relative group pixel-box-iron transition-all hover:-translate-y-1",[o.value,{"is-favorite":t.item.isFavorite}]])},[r[5]||(r[5]=e("div",{class:"pointer-events-none absolute inset-0 z-0 opacity-[0.05] bg-[repeating-linear-gradient(0deg,transparent,transparent_2px,rgba(255,255,255,0.1)_2px,rgba(255,255,255,0.1)_4px)]"},null,-1)),t.item.isFavorite?(c(),u("div",se," ★ ")):k("",!0),e("div",ae,[e("div",{class:E(["h-16 w-16 mb-2 flex items-center justify-center relative p-1",g.value])},[e("img",{src:n.value,class:"w-full h-full pixelated",alt:t.item.type},null,8,ne),t.item.enhancement>0?(c(),u("div",le," +"+i(t.item.enhancement),1)):k("",!0)],2),e("div",oe," LVL "+i(t.item.level)+" "+i(a.value),1)]),e("div",ie,[e("div",{class:E(["tooltip-header","rarity-"+t.item.rarity])},[e("div",re,[e("span",ce,i(a.value)+" "+i(t.item.type),1),e("span",de,"LVL "+i(t.item.level),1)]),t.item.enhancement>0?(c(),u("div",ue,"+"+i(t.item.enhancement)+" Enhanced",1)):k("",!0)],2),e("div",pe,[e("div",ve,[r[3]||(r[3]=e("span",{class:"label"},"Power Rating",-1)),e("span",me,i(N.value),1)]),r[4]||(r[4]=e("div",{class:"stat-row"},[e("span",{class:"label"},"Durability"),e("span",{class:"value"},"100/100")],-1))]),e("div",xe,[e("button",{onClick:r[0]||(r[0]=R(O=>m.$emit("enhance",t.item),["stop"])),class:"tip-btn enhance"},"ENHANCE"),e("button",{onClick:r[1]||(r[1]=R(O=>m.$emit("salvage",t.item),["stop"])),class:"tip-btn salvage"},"SALVAGE"),e("button",{onClick:r[2]||(r[2]=R(O=>m.$emit("toggle-favorite",t.item),["stop"])),class:"tip-btn favorite"},i(t.item.isFavorite?"UNFAVORITE":"FAVORITE"),1)])])],2))}}),be=P(ge,[["__scopeId","data-v-53b29566"]]),fe={class:"inventory-container"},_e={class:"pixel-box-iron bg-slate-900/90 p-4 mb-6 flex flex-wrap items-center justify-between gap-4"},ye={class:"flex items-center gap-4"},he={class:"flex gap-2"},ke=["onClick","data-testid"],we={class:"text-slate-500 text-xs"},Ne={class:"text-amber-300"},Ce={key:0,class:"flex flex-col items-center justify-center py-20"},Ee={key:1,class:"pixel-box-iron bg-slate-900/60 py-20 text-center"},Oe={key:2,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"},Ie=F({__name:"InventoryGrid",props:{equipment:{},isLoading:{type:Boolean}},emits:["enhance","salvage","toggle-favorite"],setup(t){const l=t,n=p("all"),N=[{id:"all",label:"ALL"},{id:"weapon",label:"WEAPONS"},{id:"shards",label:"SOUL-SHARDS"},{id:"consumable",label:"CONSUMABLES"},{id:"ring",label:"RINGS"}],f=w(()=>n.value==="all"?l.equipment:l.equipment.filter(v=>{const a=v.type.toLowerCase();return n.value==="weapon"?a.includes("wpn"):n.value==="shards"?a.includes("shard"):n.value==="ring"?a.includes("ring"):n.value==="consumable"?a.includes("pot")||a.includes("scroll"):!1}));return(v,a)=>(c(),u("div",fe,[e("div",_e,[e("div",ye,[a[0]||(a[0]=e("h2",{class:"text-amber-400 font-bold tracking-wider"},"FILTER:",-1)),e("div",he,[(c(),u(B,null,j(N,o=>e("button",{key:o.id,onClick:g=>n.value=o.id,class:E(["filter-btn",{active:n.value===o.id}]),"data-testid":"filter-"+o.id},i(o.label),11,ke)),64))])]),e("div",we,[a[1]||(a[1]=I(" ITEMS: ",-1)),e("span",Ne,i(f.value.length),1),I(" / "+i(t.equipment.length),1)])]),t.isLoading?(c(),u("div",Ce,[...a[2]||(a[2]=[e("div",{class:"animate-spin text-4xl mb-4"},"⚙️",-1),e("p",{class:"text-amber-400 animate-pulse"},"SCANNING VAULT...",-1)])])):f.value.length===0?(c(),u("div",Ee,[...a[3]||(a[3]=[e("p",{class:"text-slate-500"},"NO ITEMS FOUND IN THIS SECTOR",-1)])])):(c(),u("div",Oe,[(c(!0),u(B,null,j(f.value,o=>(c(),q(be,{key:o.id,item:o,onEnhance:g=>v.$emit("enhance",o),onSalvage:g=>v.$emit("salvage",o),onToggleFavorite:g=>v.$emit("toggle-favorite",o),"data-testid":"inventory-item"},null,8,["item","onEnhance","onSalvage","onToggleFavorite"]))),128))]))]))}}),Se=P(Ie,[["__scopeId","data-v-64d43077"]]),Te={class:"relative z-10 max-w-7xl mx-auto space-y-6"},$e={class:"pixel-box bg-slate-900/95 p-6"},Le={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},Ae={class:"flex items-center gap-4"},Ge=["src"],Re={class:"flex flex-wrap gap-3"},qe={class:"pixel-box-sm bg-slate-800/90 px-4 py-2 flex items-center gap-3"},Fe=["src"],Pe={class:"text-lg font-bold text-emerald-400"},Me={class:"pixel-box-sm bg-slate-800/90 px-4 py-2 flex items-center gap-3"},Be=["src"],je={class:"flex gap-2 text-sm font-bold"},Ve={class:"text-slate-300",title:"Common"},ze={class:"text-blue-400",title:"Rare"},De={class:"text-purple-400",title:"Fabled"},Ue={class:"pixel-box bg-slate-900/90 p-4 flex items-center justify-between"},He={class:"flex items-center gap-3"},Ye=["src"],We={class:"pixel-badge bg-slate-700 text-slate-300 px-2 py-0.5 text-xs"},Ke={class:"flex gap-2"},Qe={class:"rpg-btn-small opacity-50 cursor-not-allowed",disabled:""},Xe=["src"],Je={key:0,class:"pixel-box bg-slate-900/90 py-16 text-center"},Ze={key:1,class:"pixel-box bg-slate-900/90 py-16 text-center"},et=["src"],tt={key:0,class:"fixed inset-0 z-100 flex items-center justify-center p-4"},st={class:"pixel-box bg-slate-900 w-full max-w-md relative z-10 p-6 space-y-4"},at={class:"flex items-center justify-between mb-4"},nt={class:"text-xl font-bold text-amber-400 text-shadow-retro flex items-center gap-2"},lt=["src"],ot={key:0,class:"space-y-4"},it={class:"pixel-box-sm bg-slate-800/80 p-4 flex items-center justify-between"},rt={class:"text-center"},ct={class:"text-lg font-bold text-white"},dt={class:"text-indigo-400 text-sm"},ut={class:"text-center"},pt={class:"text-lg font-bold text-emerald-400"},vt={key:0,class:"space-y-2"},mt={class:"grid grid-cols-2 gap-2"},xt={class:"pixel-box-sm bg-slate-800/60 p-3 flex items-center justify-between"},gt={class:"pixel-box-sm bg-slate-800/60 p-3 flex items-center justify-between"},bt={class:"text-slate-400 text-sm"},ft={key:1,class:"pixel-box-sm bg-red-900/30 border-red-500/50 p-3 text-red-300 text-sm"},_t={class:"flex gap-3 pt-2"},yt=["disabled"],ht={key:0,class:"fixed inset-0 z-100 flex items-center justify-center p-4"},kt={class:"pixel-box bg-slate-900 w-full max-w-md relative z-10 p-6 space-y-4"},wt={class:"flex items-center justify-between mb-4"},Nt={class:"text-xl font-bold text-red-400 text-shadow-retro flex items-center gap-2"},Ct=["src"],Et={key:0,class:"space-y-4"},Ot={class:"flex gap-3 pt-2"},It=["disabled"],St=F({__name:"Inventory",setup(t){const l={BG_DUNGEON:"https://vibemedia.space/bg_dungeon_vault_8x9y0z_v1.png?prompt=dark%20dungeon%20stone%20floor%20tile%20texture%20seamless&style=pixel_game_asset&key=NOGON",ICON_CHEST:"https://vibemedia.space/icon_chest_inv_1a2b3c_v1.png?prompt=golden%20treasure%20chest%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_CHEST_EMPTY:"https://vibemedia.space/icon_chest_empty_4d5e6f_v1.png?prompt=empty%20wooden%20chest%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_CRYSTAL:"https://vibemedia.space/icon_crystal_7g8h9i_v1.png?prompt=glowing%20green%20energy%20crystal%20pixel%20art&style=pixel_game_asset&key=NOGON",ICON_COIN:"https://vibemedia.space/icon_coin_stack_0j1k2l_v1.png?prompt=stack%20of%20gold%20coins%20pixel%20art&style=pixel_game_asset&key=NOGON",ICON_SWORD:"https://vibemedia.space/icon_sword_inv_3m4n5o_v1.png?prompt=steel%20sword%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_SCROLL:"https://vibemedia.space/icon_scroll_inv_6p7q8r_v1.png?prompt=ancient%20scroll%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_ANVIL:"https://vibemedia.space/icon_anvil_9s0t1u_v1.png?prompt=blacksmith%20anvil%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_SKULL:"https://vibemedia.space/icon_skull_inv_2v3w4x_v1.png?prompt=skull%20warning%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON"},n=te(),N=z(),f=p(!1),v=p(!1),a=p(null),o=p(null),g=p(null),m=p(!1),r=p(!1),O=w(()=>o.value?n.particles>=o.value.particles:!1),$=w(()=>{if(!o.value)return!1;const _=o.value.tokenType.toLowerCase();return _==="common"?n.commonTokens>=o.value.tokens:_==="rare"?n.rareTokens>=o.value.tokens:_==="fabled"?n.fabledTokens>=o.value.tokens:_==="mythic"?n.mythicTokens>=o.value.tokens:!1}),L=w(()=>O.value&&$.value),A=async()=>{await Promise.all([n.fetchBalances(),n.fetchInventory()])},x=async _=>{a.value=_,o.value=null,g.value=null,f.value=!0;try{N.token&&(o.value=await J(N.token,_.id))}catch{g.value="Failed to calculate enhancement cost."}},d=()=>{f.value=!1,a.value=null},b=async()=>{if(a.value){m.value=!0;try{await n.enhanceItem(a.value.id),d()}catch{g.value="Enhancement failed."}finally{m.value=!1}}},C=_=>{a.value=_,v.value=!0},y=()=>{v.value=!1,a.value=null},D=async()=>{if(a.value){r.value=!0;try{await n.salvageItem(a.value.id),y()}catch(_){console.error(_)}finally{r.value=!1}}};return H(()=>{A()}),(_,s)=>(c(),u("div",{class:"min-h-screen p-4 md:p-8 font-mono",style:W({backgroundImage:`url('${l.BG_DUNGEON}')`,backgroundSize:"128px 128px",imageRendering:"pixelated"})},[s[19]||(s[19]=e("div",{class:"pointer-events-none fixed inset-0 z-50 opacity-[0.03] bg-[repeating-linear-gradient(0deg,transparent,transparent_2px,rgba(0,0,0,0.3)_2px,rgba(0,0,0,0.3)_4px)]"},null,-1)),s[20]||(s[20]=e("div",{class:"pointer-events-none fixed inset-0 z-40 bg-[radial-gradient(ellipse_at_center,transparent_0%,rgba(0,0,0,0.4)_100%)]"},null,-1)),e("div",Te,[e("header",$e,[e("div",Le,[e("div",Ae,[e("img",{src:l.ICON_CHEST,alt:"",class:"w-12 h-12 pixelated"},null,8,Ge),s[1]||(s[1]=e("div",null,[e("h1",{class:"text-2xl md:text-3xl font-bold text-amber-400 text-shadow-retro tracking-wide"}," TREASURY VAULT "),e("p",{class:"text-slate-400 text-sm mt-1"}," Manage thy equipment and resources ")],-1))]),e("div",Re,[e("div",qe,[e("img",{src:l.ICON_CRYSTAL,alt:"",class:"w-6 h-6 pixelated"},null,8,Fe),e("div",null,[s[2]||(s[2]=e("div",{class:"text-[10px] uppercase text-slate-500 tracking-wider"},"Particles",-1)),e("div",Pe,i(h(n).particles.toLocaleString()),1)])]),e("div",Me,[e("img",{src:l.ICON_COIN,alt:"",class:"w-6 h-6 pixelated"},null,8,Be),e("div",null,[s[3]||(s[3]=e("div",{class:"text-[10px] uppercase text-slate-500 tracking-wider"},"Tokens",-1)),e("div",je,[e("span",Ve,i(h(n).commonTokens),1),e("span",ze,i(h(n).rareTokens),1),e("span",De,i(h(n).fabledTokens),1)])])])])])]),e("div",Ue,[e("div",He,[e("img",{src:l.ICON_SWORD,alt:"",class:"w-5 h-5 pixelated"},null,8,Ye),s[4]||(s[4]=e("h2",{class:"text-lg font-bold text-amber-300"},"EQUIPMENT",-1)),e("span",We,i(h(n).totalEquipment),1)]),e("div",Ke,[e("button",Qe,[e("img",{src:l.ICON_SCROLL,alt:"",class:"w-4 h-4 pixelated mr-1"},null,8,Xe),s[5]||(s[5]=I(" FILTER ",-1))]),e("button",{class:"rpg-btn-small",onClick:A},[...s[6]||(s[6]=[e("span",{class:"mr-1"},"↻",-1),I(" REFRESH ",-1)])])])]),h(n).isLoading?(c(),u("div",Je,[...s[7]||(s[7]=[e("div",{class:"inline-block animate-spin text-4xl mb-4"},"⚙️",-1),e("p",{class:"text-amber-400 text-shadow-retro animate-pulse"},"Accessing vault...",-1)])])):h(n).equipment.length===0?(c(),u("div",Ze,[e("img",{src:l.ICON_CHEST_EMPTY,alt:"",class:"w-16 h-16 pixelated mx-auto mb-4 opacity-50"},null,8,et),s[8]||(s[8]=e("h3",{class:"text-lg font-bold text-slate-400"},"Vault is Empty",-1)),s[9]||(s[9]=e("p",{class:"text-slate-500 text-sm mt-2"},"Win battles to earn equipment crates",-1))])):k("",!0),Y(Se,{equipment:h(n).equipment,isLoading:h(n).isLoading,onEnhance:x,onSalvage:C,onToggleFavorite:s[0]||(s[0]=M=>h(n).toggleFavorite(M.id,!M.isFavorite))},null,8,["equipment","isLoading"]),(c(),q(V,{to:"body"},[f.value?(c(),u("div",tt,[e("div",{class:"absolute inset-0 bg-black/80",onClick:d}),e("div",st,[e("div",at,[e("h3",nt,[e("img",{src:l.ICON_ANVIL,alt:"",class:"w-6 h-6 pixelated"},null,8,lt),s[10]||(s[10]=I(" ENHANCE GEAR ",-1))]),e("button",{class:"text-slate-500 hover:text-white text-xl",onClick:d},"✕")]),a.value?(c(),u("div",ot,[e("div",it,[e("div",rt,[s[11]||(s[11]=e("div",{class:"text-xs text-slate-500 uppercase"},"Current",-1)),e("div",ct,[I(" Lvl "+i(a.value.level)+" ",1),e("span",dt,"(+"+i(a.value.enhancement)+")",1)])]),s[13]||(s[13]=e("div",{class:"text-2xl text-amber-500 animate-pulse"},"→",-1)),e("div",ut,[s[12]||(s[12]=e("div",{class:"text-xs text-slate-500 uppercase"},"Next",-1)),e("div",pt,"+"+i(a.value.enhancement+1),1)])]),o.value?(c(),u("div",vt,[s[15]||(s[15]=e("h4",{class:"text-xs font-bold text-slate-500 uppercase tracking-wider"},"Required",-1)),e("div",mt,[e("div",xt,[s[14]||(s[14]=e("span",{class:"text-slate-400 text-sm"},"Particles",-1)),e("span",{class:E(["font-bold",O.value?"text-emerald-400":"text-red-400"])},i(o.value.particles),3)]),e("div",gt,[e("span",bt,i(o.value.tokenType),1),e("span",{class:E(["font-bold",$.value?"text-emerald-400":"text-red-400"])},i(o.value.tokens),3)])])])):k("",!0),g.value?(c(),u("div",ft,i(g.value),1)):k("",!0),e("div",_t,[e("button",{class:"rpg-btn-small flex-1 bg-slate-700 hover:bg-slate-600",onClick:d}," CANCEL "),e("button",{class:E(["rpg-btn flex-1",{"opacity-50 cursor-not-allowed":!L.value||m.value}]),disabled:!L.value||m.value,onClick:b},i(m.value?"FORGING...":"ENHANCE"),11,yt)])])):k("",!0)])])):k("",!0)])),(c(),q(V,{to:"body"},[v.value?(c(),u("div",ht,[e("div",{class:"absolute inset-0 bg-black/80",onClick:y}),e("div",kt,[e("div",wt,[e("h3",Nt,[e("img",{src:l.ICON_SKULL,alt:"",class:"w-6 h-6 pixelated"},null,8,Ct),s[16]||(s[16]=I(" SALVAGE GEAR ",-1))]),e("button",{class:"text-slate-500 hover:text-white text-xl",onClick:y},"✕")]),a.value?(c(),u("div",Et,[s[17]||(s[17]=e("p",{class:"text-slate-300"}," Art thou certain? This cannot be undone. ",-1)),s[18]||(s[18]=e("div",{class:"pixel-box-sm bg-red-900/20 border-red-500/30 p-4 flex items-center gap-3"},[e("span",{class:"text-2xl"},"⚠️"),e("span",{class:"text-red-200 text-sm"},"Item will be destroyed and converted to Particles.")],-1)),e("div",Ot,[e("button",{class:"rpg-btn-small flex-1 bg-slate-700 hover:bg-slate-600",onClick:y}," CANCEL "),e("button",{class:E(["rpg-btn flex-1 bg-red-700 hover:bg-red-600 border-red-800",{"opacity-50 cursor-not-allowed":r.value}]),disabled:r.value,onClick:D},i(r.value?"SALVAGING...":"DESTROY"),11,It)])])):k("",!0)])])):k("",!0)]))])],4))}}),$t=P(St,[["__scopeId","data-v-d57dd5f3"]]);export{$t as default};
