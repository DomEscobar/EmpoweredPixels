import{C as E,D as T,E as z,u as j,l as p,d as B,o as u,c as b,n as N,a as e,t as c,k as q,j as O,x as C,y as D,e as h,b as I,F as V,s as H,f as R,B as P,q as U,_ as Y}from"./index-hTt4IoxS.js";async function W(s){return(await E(`${T.inventory}/balance/particles`,{token:s})).balance}async function G(s,n){return(await E(`${T.inventory}/balance/token/${n}`,{token:s})).balance}async function K(s,n){return E(`${T.equipment}/inventory`,{method:"POST",token:s,body:n})}async function Q(s,n){return E(`${T.equipment}/enhance`,{method:"POST",token:s,body:{equipmentId:n}})}async function X(s,n){return E(`${T.equipment}/enhance/cost`,{method:"POST",token:s,body:{equipmentId:n}})}async function J(s,n){return{particles:(await E(`${T.equipment}/salvage`,{method:"POST",token:s,body:{equipmentId:n}})).length}}async function Z(s,n,a){return E(`${T.equipment}/${n}/favorite`,{method:a?"POST":"DELETE",token:s})}const ee=z("inventory",()=>{const s=j(),n=p(0),a=p(0),_=p(0),k=p(0),w=p(0),l=p([]),o=p(0),x=p(!1),r=p(null);async function g(){if(s.token)try{const[d,i,v,y,f]=await Promise.all([W(s.token),G(s.token,"common"),G(s.token,"rare"),G(s.token,"fabled"),G(s.token,"mythic")]);n.value=d,a.value=i,_.value=v,k.value=y,w.value=f}catch(d){console.error("Failed to fetch balances",d)}}async function S(d=1,i=20,v,y){if(s.token){x.value=!0,r.value=null;try{const f=await K(s.token,{page:d,pageSize:i,filter:v,sort:y});l.value=f.items,o.value=f.totalCount}catch(f){r.value=f.message||"Failed to fetch inventory"}finally{x.value=!1}}}async function L(d){if(s.token)try{const i=await Q(s.token,d),v=l.value.findIndex(y=>y.id===d);return v!==-1&&(l.value[v]=i),await g(),i}catch(i){throw i}}async function $(d){if(s.token)try{const i=await J(s.token,d);return l.value=l.value.filter(v=>v.id!==d),o.value--,await g(),i}catch(i){throw i}}async function A(d,i){if(s.token)try{await Z(s.token,d,i);const v=l.value.find(y=>y.id===d);v&&(v.isFavorite=i)}catch(v){console.error("Failed to toggle favorite",v)}}return{particles:n,commonTokens:a,rareTokens:_,fabledTokens:k,mythicTokens:w,equipment:l,totalEquipment:o,isLoading:x,error:r,fetchBalances:g,fetchInventory:S,enhanceItem:L,salvageItem:$,toggleFavorite:A}}),te={class:"flex items-start justify-between mb-3"},se={class:"mt-1 text-xs text-slate-400"},ae={class:"flex gap-2"},ne={class:"flex items-center justify-center py-4 relative"},le={key:0,class:"absolute -right-2 top-2 bg-indigo-600 text-white text-xs font-bold px-2 py-0.5 rounded-full border border-indigo-400 shadow-sm"},oe={class:"mt-4 grid grid-cols-2 gap-2 opacity-0 group-hover:opacity-100 transition-opacity"},ie=B({__name:"EquipmentCard",props:{item:{}},emits:["enhance","salvage","toggle-favorite"],setup(s){const n=s,a={0:{name:"Basic",border:"border-slate-700",badge:"bg-slate-700 text-slate-300 border-slate-600",icon:"bg-slate-800 border-slate-700"},1:{name:"Common",border:"border-slate-600",badge:"bg-slate-700 text-white border-slate-500",icon:"bg-slate-700 border-slate-600"},2:{name:"Rare",border:"border-blue-500/30",badge:"bg-blue-900/30 text-blue-300 border-blue-500/30",icon:"bg-blue-900/20 border-blue-500/30"},3:{name:"Fabled",border:"border-purple-500/30",badge:"bg-purple-900/30 text-purple-300 border-purple-500/30",icon:"bg-purple-900/20 border-purple-500/30"},4:{name:"Mythic",border:"border-amber-500/30",badge:"bg-amber-900/30 text-amber-300 border-amber-500/30",icon:"bg-amber-900/20 border-amber-500/30"},5:{name:"Legendary",border:"border-red-500/30",badge:"bg-red-900/30 text-red-300 border-red-500/30",icon:"bg-red-900/20 border-red-500/30"}},_=C(()=>a[n.item.rarity]||a[0]),k=C(()=>_.value.name),w=C(()=>_.value.border),l=C(()=>_.value.badge),o=C(()=>_.value.icon);return(x,r)=>(u(),b("div",{class:N(["relative group rounded-lg border bg-slate-800/50 p-4 transition-all hover:bg-slate-800",[w.value,{"ring-2 ring-indigo-500":s.item.isFavorite}]])},[e("div",te,[e("div",null,[e("span",{class:N(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium border",l.value])},c(k.value),3),e("div",se,"Lvl "+c(s.item.level),1)]),e("div",ae,[e("button",{onClick:r[0]||(r[0]=q(g=>x.$emit("toggle-favorite",s.item),["stop"])),class:N(["text-slate-500 hover:text-yellow-400 transition-colors",{"text-yellow-400":s.item.isFavorite}]),title:"Toggle Favorite"},[...r[3]||(r[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)])],2)])]),e("div",ne,[e("div",{class:N(["h-16 w-16 rounded-lg flex items-center justify-center text-3xl shadow-lg border",o.value])}," ⚔️ ",2),s.item.enhancement>0?(u(),b("div",le," +"+c(s.item.enhancement),1)):O("",!0)]),e("div",oe,[e("button",{onClick:r[1]||(r[1]=q(g=>x.$emit("enhance",s.item),["stop"])),class:"flex items-center justify-center px-3 py-1.5 text-xs font-medium text-white bg-indigo-600 rounded hover:bg-indigo-500 transition-colors"}," Enhance "),e("button",{onClick:r[2]||(r[2]=q(g=>x.$emit("salvage",s.item),["stop"])),class:"flex items-center justify-center px-3 py-1.5 text-xs font-medium text-red-300 bg-red-900/30 rounded hover:bg-red-900/50 transition-colors border border-red-900/50"}," Salvage ")])],2))}}),re={class:"relative z-10 max-w-7xl mx-auto space-y-6"},ce={class:"pixel-box bg-slate-900/95 p-6"},de={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ue={class:"flex items-center gap-4"},pe=["src"],ve={class:"flex flex-wrap gap-3"},xe={class:"pixel-box-sm bg-slate-800/90 px-4 py-2 flex items-center gap-3"},me=["src"],be={class:"text-lg font-bold text-emerald-400"},ge={class:"pixel-box-sm bg-slate-800/90 px-4 py-2 flex items-center gap-3"},fe=["src"],_e={class:"flex gap-2 text-sm font-bold"},ye={class:"text-slate-300",title:"Common"},he={class:"text-blue-400",title:"Rare"},ke={class:"text-purple-400",title:"Fabled"},we={class:"pixel-box bg-slate-900/90 p-4 flex items-center justify-between"},Ce={class:"flex items-center gap-3"},Ne=["src"],Oe={class:"pixel-badge bg-slate-700 text-slate-300 px-2 py-0.5 text-xs"},Ee={class:"flex gap-2"},Te={class:"rpg-btn-small opacity-50 cursor-not-allowed",disabled:""},Ie=["src"],Se={key:0,class:"pixel-box bg-slate-900/90 py-16 text-center"},Le={key:1,class:"pixel-box bg-slate-900/90 py-16 text-center"},$e=["src"],Ae={key:2,class:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"},Fe={key:0,class:"fixed inset-0 z-100 flex items-center justify-center p-4"},Ge={class:"pixel-box bg-slate-900 w-full max-w-md relative z-10 p-6 space-y-4"},qe={class:"flex items-center justify-between mb-4"},Re={class:"text-xl font-bold text-amber-400 text-shadow-retro flex items-center gap-2"},Pe=["src"],je={key:0,class:"space-y-4"},Be={class:"pixel-box-sm bg-slate-800/80 p-4 flex items-center justify-between"},Me={class:"text-center"},ze={class:"text-lg font-bold text-white"},De={class:"text-indigo-400 text-sm"},Ve={class:"text-center"},He={class:"text-lg font-bold text-emerald-400"},Ue={key:0,class:"space-y-2"},Ye={class:"grid grid-cols-2 gap-2"},We={class:"pixel-box-sm bg-slate-800/60 p-3 flex items-center justify-between"},Ke={class:"pixel-box-sm bg-slate-800/60 p-3 flex items-center justify-between"},Qe={class:"text-slate-400 text-sm"},Xe={key:1,class:"pixel-box-sm bg-red-900/30 border-red-500/50 p-3 text-red-300 text-sm"},Je={class:"flex gap-3 pt-2"},Ze=["disabled"],et={key:0,class:"fixed inset-0 z-100 flex items-center justify-center p-4"},tt={class:"pixel-box bg-slate-900 w-full max-w-md relative z-10 p-6 space-y-4"},st={class:"flex items-center justify-between mb-4"},at={class:"text-xl font-bold text-red-400 text-shadow-retro flex items-center gap-2"},nt=["src"],lt={key:0,class:"space-y-4"},ot={class:"flex gap-3 pt-2"},it=["disabled"],rt=B({__name:"Inventory",setup(s){const n={BG_DUNGEON:"https://vibemedia.space/bg_dungeon_vault_8x9y0z_v1.png?prompt=dark%20dungeon%20stone%20floor%20tile%20texture%20seamless&style=pixel_game_asset&key=NOGON",ICON_CHEST:"https://vibemedia.space/icon_chest_inv_1a2b3c_v1.png?prompt=golden%20treasure%20chest%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_CHEST_EMPTY:"https://vibemedia.space/icon_chest_empty_4d5e6f_v1.png?prompt=empty%20wooden%20chest%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_CRYSTAL:"https://vibemedia.space/icon_crystal_7g8h9i_v1.png?prompt=glowing%20green%20energy%20crystal%20pixel%20art&style=pixel_game_asset&key=NOGON",ICON_COIN:"https://vibemedia.space/icon_coin_stack_0j1k2l_v1.png?prompt=stack%20of%20gold%20coins%20pixel%20art&style=pixel_game_asset&key=NOGON",ICON_SWORD:"https://vibemedia.space/icon_sword_inv_3m4n5o_v1.png?prompt=steel%20sword%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_SCROLL:"https://vibemedia.space/icon_scroll_inv_6p7q8r_v1.png?prompt=ancient%20scroll%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_ANVIL:"https://vibemedia.space/icon_anvil_9s0t1u_v1.png?prompt=blacksmith%20anvil%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON",ICON_SKULL:"https://vibemedia.space/icon_skull_inv_2v3w4x_v1.png?prompt=skull%20warning%20pixel%20art%20icon&style=pixel_game_asset&key=NOGON"},a=ee(),_=j(),k=p(!1),w=p(!1),l=p(null),o=p(null),x=p(null),r=p(!1),g=p(!1),S=C(()=>o.value?a.particles>=o.value.particles:!1),L=C(()=>{if(!o.value)return!1;const m=o.value.tokenType.toLowerCase();return m==="common"?a.commonTokens>=o.value.tokens:m==="rare"?a.rareTokens>=o.value.tokens:m==="fabled"?a.fabledTokens>=o.value.tokens:m==="mythic"?a.mythicTokens>=o.value.tokens:!1}),$=C(()=>S.value&&L.value),A=async()=>{await Promise.all([a.fetchBalances(),a.fetchInventory()])},d=async m=>{l.value=m,o.value=null,x.value=null,k.value=!0;try{_.token&&(o.value=await X(_.token,m.id))}catch{x.value="Failed to calculate enhancement cost."}},i=()=>{k.value=!1,l.value=null},v=async()=>{if(l.value){r.value=!0;try{await a.enhanceItem(l.value.id),i()}catch{x.value="Enhancement failed."}finally{r.value=!1}}},y=m=>{l.value=m,w.value=!0},f=()=>{w.value=!1,l.value=null},M=async()=>{if(l.value){g.value=!0;try{await a.salvageItem(l.value.id),f()}catch(m){console.error(m)}finally{g.value=!1}}};return D(()=>{A()}),(m,t)=>(u(),b("div",{class:"min-h-screen p-4 md:p-8 font-mono",style:U({backgroundImage:`url('${n.BG_DUNGEON}')`,backgroundSize:"128px 128px",imageRendering:"pixelated"})},[t[18]||(t[18]=e("div",{class:"pointer-events-none fixed inset-0 z-50 opacity-[0.03] bg-[repeating-linear-gradient(0deg,transparent,transparent_2px,rgba(0,0,0,0.3)_2px,rgba(0,0,0,0.3)_4px)]"},null,-1)),t[19]||(t[19]=e("div",{class:"pointer-events-none fixed inset-0 z-40 bg-[radial-gradient(ellipse_at_center,transparent_0%,rgba(0,0,0,0.4)_100%)]"},null,-1)),e("div",re,[e("header",ce,[e("div",de,[e("div",ue,[e("img",{src:n.ICON_CHEST,alt:"",class:"w-12 h-12 pixelated"},null,8,pe),t[0]||(t[0]=e("div",null,[e("h1",{class:"text-2xl md:text-3xl font-bold text-amber-400 text-shadow-retro tracking-wide"}," TREASURY VAULT "),e("p",{class:"text-slate-400 text-sm mt-1"}," Manage thy equipment and resources ")],-1))]),e("div",ve,[e("div",xe,[e("img",{src:n.ICON_CRYSTAL,alt:"",class:"w-6 h-6 pixelated"},null,8,me),e("div",null,[t[1]||(t[1]=e("div",{class:"text-[10px] uppercase text-slate-500 tracking-wider"},"Particles",-1)),e("div",be,c(h(a).particles.toLocaleString()),1)])]),e("div",ge,[e("img",{src:n.ICON_COIN,alt:"",class:"w-6 h-6 pixelated"},null,8,fe),e("div",null,[t[2]||(t[2]=e("div",{class:"text-[10px] uppercase text-slate-500 tracking-wider"},"Tokens",-1)),e("div",_e,[e("span",ye,c(h(a).commonTokens),1),e("span",he,c(h(a).rareTokens),1),e("span",ke,c(h(a).fabledTokens),1)])])])])])]),e("div",we,[e("div",Ce,[e("img",{src:n.ICON_SWORD,alt:"",class:"w-5 h-5 pixelated"},null,8,Ne),t[3]||(t[3]=e("h2",{class:"text-lg font-bold text-amber-300"},"EQUIPMENT",-1)),e("span",Oe,c(h(a).totalEquipment),1)]),e("div",Ee,[e("button",Te,[e("img",{src:n.ICON_SCROLL,alt:"",class:"w-4 h-4 pixelated mr-1"},null,8,Ie),t[4]||(t[4]=I(" FILTER ",-1))]),e("button",{class:"rpg-btn-small",onClick:A},[...t[5]||(t[5]=[e("span",{class:"mr-1"},"↻",-1),I(" REFRESH ",-1)])])])]),h(a).isLoading?(u(),b("div",Se,[...t[6]||(t[6]=[e("div",{class:"inline-block animate-spin text-4xl mb-4"},"⚙️",-1),e("p",{class:"text-amber-400 text-shadow-retro animate-pulse"},"Accessing vault...",-1)])])):h(a).equipment.length===0?(u(),b("div",Le,[e("img",{src:n.ICON_CHEST_EMPTY,alt:"",class:"w-16 h-16 pixelated mx-auto mb-4 opacity-50"},null,8,$e),t[7]||(t[7]=e("h3",{class:"text-lg font-bold text-slate-400"},"Vault is Empty",-1)),t[8]||(t[8]=e("p",{class:"text-slate-500 text-sm mt-2"},"Win battles to earn equipment crates",-1))])):(u(),b("div",Ae,[(u(!0),b(V,null,H(h(a).equipment,F=>(u(),R(ie,{key:F.id,item:F,onEnhance:d,onSalvage:y,onToggleFavorite:ct=>h(a).toggleFavorite(F.id,!F.isFavorite)},null,8,["item","onToggleFavorite"]))),128))])),(u(),R(P,{to:"body"},[k.value?(u(),b("div",Fe,[e("div",{class:"absolute inset-0 bg-black/80",onClick:i}),e("div",Ge,[e("div",qe,[e("h3",Re,[e("img",{src:n.ICON_ANVIL,alt:"",class:"w-6 h-6 pixelated"},null,8,Pe),t[9]||(t[9]=I(" ENHANCE GEAR ",-1))]),e("button",{class:"text-slate-500 hover:text-white text-xl",onClick:i},"✕")]),l.value?(u(),b("div",je,[e("div",Be,[e("div",Me,[t[10]||(t[10]=e("div",{class:"text-xs text-slate-500 uppercase"},"Current",-1)),e("div",ze,[I(" Lvl "+c(l.value.level)+" ",1),e("span",De,"(+"+c(l.value.enhancement)+")",1)])]),t[12]||(t[12]=e("div",{class:"text-2xl text-amber-500 animate-pulse"},"→",-1)),e("div",Ve,[t[11]||(t[11]=e("div",{class:"text-xs text-slate-500 uppercase"},"Next",-1)),e("div",He,"+"+c(l.value.enhancement+1),1)])]),o.value?(u(),b("div",Ue,[t[14]||(t[14]=e("h4",{class:"text-xs font-bold text-slate-500 uppercase tracking-wider"},"Required",-1)),e("div",Ye,[e("div",We,[t[13]||(t[13]=e("span",{class:"text-slate-400 text-sm"},"Particles",-1)),e("span",{class:N(["font-bold",S.value?"text-emerald-400":"text-red-400"])},c(o.value.particles),3)]),e("div",Ke,[e("span",Qe,c(o.value.tokenType),1),e("span",{class:N(["font-bold",L.value?"text-emerald-400":"text-red-400"])},c(o.value.tokens),3)])])])):O("",!0),x.value?(u(),b("div",Xe,c(x.value),1)):O("",!0),e("div",Je,[e("button",{class:"rpg-btn-small flex-1 bg-slate-700 hover:bg-slate-600",onClick:i}," CANCEL "),e("button",{class:N(["rpg-btn flex-1",{"opacity-50 cursor-not-allowed":!$.value||r.value}]),disabled:!$.value||r.value,onClick:v},c(r.value?"FORGING...":"ENHANCE"),11,Ze)])])):O("",!0)])])):O("",!0)])),(u(),R(P,{to:"body"},[w.value?(u(),b("div",et,[e("div",{class:"absolute inset-0 bg-black/80",onClick:f}),e("div",tt,[e("div",st,[e("h3",at,[e("img",{src:n.ICON_SKULL,alt:"",class:"w-6 h-6 pixelated"},null,8,nt),t[15]||(t[15]=I(" SALVAGE GEAR ",-1))]),e("button",{class:"text-slate-500 hover:text-white text-xl",onClick:f},"✕")]),l.value?(u(),b("div",lt,[t[16]||(t[16]=e("p",{class:"text-slate-300"}," Art thou certain? This cannot be undone. ",-1)),t[17]||(t[17]=e("div",{class:"pixel-box-sm bg-red-900/20 border-red-500/30 p-4 flex items-center gap-3"},[e("span",{class:"text-2xl"},"⚠️"),e("span",{class:"text-red-200 text-sm"},"Item will be destroyed and converted to Particles.")],-1)),e("div",ot,[e("button",{class:"rpg-btn-small flex-1 bg-slate-700 hover:bg-slate-600",onClick:f}," CANCEL "),e("button",{class:N(["rpg-btn flex-1 bg-red-700 hover:bg-red-600 border-red-800",{"opacity-50 cursor-not-allowed":g.value}]),disabled:g.value,onClick:M},c(g.value?"SALVAGING...":"DESTROY"),11,it)])])):O("",!0)])])):O("",!0)]))])],4))}}),ut=Y(rt,[["__scopeId","data-v-12c677de"]]);export{ut as default};
