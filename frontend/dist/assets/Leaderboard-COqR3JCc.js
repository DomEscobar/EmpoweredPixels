import{E as F,u as b,d as N,y as S,o as r,c as i,a as e,h as B,e as h,t as l,j as v,F as x,s as p,b as w,q as A,l as j,x as E,n as _}from"./index-CmYkeO4Y.js";const f="",g={power:{name:"Power Ranking",icon:"‚öîÔ∏è",description:"Total fighter power"},wealth:{name:"Wealth Ranking",icon:"üí∞",description:"Gold accumulated"},combat:{name:"Combat Ranking",icon:"üèÜ",description:"Matches won"},achievements:{name:"Achievement Points",icon:"‚≠ê",description:"Total achievement score"},streak:{name:"Win Streak",icon:"üî•",description:"Current consecutive wins"}};async function z(n,a,t=10,c=0){const m=await fetch(`${f}/api/leaderboard/${a}?limit=${t}&offset=${c}`,{headers:{Authorization:`Bearer ${n}`}});if(!m.ok)throw new Error("Failed to fetch leaderboard");return m.json()}async function P(n,a,t=5){const c=await fetch(`${f}/api/leaderboard/${a}/nearby?range=${t}`,{headers:{Authorization:`Bearer ${n}`}});if(!c.ok)throw new Error("Failed to fetch nearby ranks");return c.json()}async function G(n){const a=await fetch(`${f}/api/achievements`,{headers:{Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error("Failed to fetch achievements");return a.json()}async function O(n){const a=await fetch(`${f}/api/player/achievements`,{headers:{Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error("Failed to fetch player achievements");return a.json()}async function T(n,a){const t=await fetch(`${f}/api/achievement/${a}/claim`,{method:"POST",headers:{Authorization:`Bearer ${n}`}});if(!t.ok)throw new Error("Failed to claim achievement");return t.json()}const M=F("leaderboard",{state:()=>({currentCategory:"power",leaderboard:null,nearbyRanks:null,achievements:[],playerAchievements:[],isLoading:!1,isLoadingAchievements:!1,error:null}),getters:{topEntries:n=>n.leaderboard?.entries.slice(0,10)||[],userRank:n=>n.leaderboard?.user_rank||0,userEntry:n=>n.leaderboard?.user_entry,completedAchievements:n=>n.playerAchievements.filter(a=>a.completed),unclaimedAchievements:n=>n.playerAchievements.filter(a=>a.completed&&!a.claimed),progressByCategory:n=>{const a={};return n.playerAchievements.forEach(t=>{const c=t.achievement?.category||"other";a[c]||(a[c]={total:0,completed:0}),a[c].total++,t.completed&&a[c].completed++}),a}},actions:{async fetchLeaderboard(n,a=10,t=0){const c=b();if(!c.token)return;const m=n||this.currentCategory;this.currentCategory=m,this.isLoading=!0,this.error=null;try{this.leaderboard=await z(c.token,m,a,t)}catch(y){this.error=y.message||"Failed to load leaderboard"}finally{this.isLoading=!1}},async fetchNearbyRanks(n,a=5){const t=b();if(!t.token)return;const c=n||this.currentCategory;this.isLoading=!0,this.error=null;try{this.nearbyRanks=await P(t.token,c,a)}catch(m){this.error=m.message||"Failed to load nearby ranks"}finally{this.isLoading=!1}},async fetchAchievements(){const n=b();if(n.token){this.isLoadingAchievements=!0;try{this.achievements=await G(n.token)}catch(a){console.error("Failed to fetch achievements",a)}finally{this.isLoadingAchievements=!1}}},async fetchPlayerAchievements(){const n=b();if(n.token){this.isLoadingAchievements=!0;try{this.playerAchievements=await O(n.token)}catch(a){console.error("Failed to fetch player achievements",a)}finally{this.isLoadingAchievements=!1}}},async claimAchievementReward(n){const a=b();if(a.token)try{await T(a.token,n),await this.fetchPlayerAchievements()}catch(t){throw this.error=t.message||"Failed to claim reward",t}},clearError(){this.error=null}}}),V={class:"relative z-10 max-w-6xl mx-auto space-y-6"},D={class:"pixel-box bg-slate-900/95 p-6"},I={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},U={key:0,class:"pixel-box-sm bg-amber-900/30 border-amber-500/50 px-4 py-2"},W={class:"flex items-center gap-2"},Y={class:"text-2xl font-black text-white"},q={key:0,class:"text-green-400"},H={key:1,class:"text-red-400"},K={class:"text-xs text-slate-400"},X={class:"flex flex-wrap gap-2"},J=["onClick"],Q={class:"mr-1"},Z={class:"grid lg:grid-cols-3 gap-6"},ee={class:"lg:col-span-2 space-y-4"},te={class:"pixel-box bg-slate-900/90 p-4"},se={class:"text-lg font-bold text-amber-400 mb-4 flex items-center gap-2"},ae={class:"text-xs text-slate-500 font-normal"},ne={key:0,class:"py-12 text-center"},oe={key:1,class:"space-y-2"},re={class:"w-10 text-center"},ie={key:0,class:"text-2xl"},le={key:1,class:"text-lg font-bold text-slate-400"},ce={class:"flex-1"},de={class:"font-bold text-white"},he={class:"text-xs text-slate-500"},me={key:0,class:"text-green-400"},ue={key:1,class:"text-red-400"},xe={key:2},pe={class:"text-right"},be={class:"font-black text-amber-400"},fe={key:0,class:"py-12 text-center text-slate-500"},ve={key:0,class:"pixel-box bg-slate-900/90 p-4"},_e={class:"space-y-1"},ge={class:"flex-1 truncate"},ye={class:"font-bold text-amber-400"},ke={class:"space-y-4"},we={class:"pixel-box bg-slate-900/90 p-4"},Ae={class:"mb-4 space-y-2"},Ee={class:"flex justify-between text-xs mb-1"},Le={class:"text-slate-400 capitalize"},Ce={class:"text-amber-400"},$e={class:"h-1.5 bg-slate-700 rounded-full overflow-hidden"},Re={class:"space-y-2 max-h-[400px] overflow-y-auto custom-scrollbar"},Fe=["onClick"],Ne={class:"flex items-start gap-3"},Se={class:"text-2xl"},Be={class:"flex-1"},je={class:"font-bold text-amber-400 text-sm"},ze={class:"text-xs text-slate-400"},Pe={class:"mt-1 text-xs text-green-400 font-bold"},Ge={class:"flex items-start gap-3"},Oe={class:"text-2xl"},Te={class:"flex-1"},Me={class:"font-bold text-slate-300 text-sm"},Ve={class:"text-xs text-slate-500"},Ue=N({__name:"Leaderboard",setup(n){const a={BG_DUNGEON:"https://vibemedia.space/bg_dungeon_v2_99283.png?prompt=dark%20dungeon%20floor%20tile%20texture%20seamless&style=pixel_game_asset&key=NOGON"},t=M(),c=j("power"),m=E(()=>t.unclaimedAchievements),y=E(()=>t.completedAchievements);function L(d){c.value=d,t.fetchLeaderboard(d),t.fetchNearbyRanks(d)}function C(d,o){return d.user_id===t.leaderboard?.user_entry?.user_id?"bg-amber-900/30 border-amber-500/50":o===0?"bg-yellow-900/20 border-yellow-500/30":o===1?"bg-slate-700/30 border-slate-400/30":o===2?"bg-orange-900/20 border-orange-500/30":"bg-slate-800/50"}function $(d){return d===1?"ü•á":d===2?"ü•à":d===3?"ü•â":`#${d}`}function k(d){return d>=1e6?`${(d/1e6).toFixed(1)}M`:d>=1e3?`${(d/1e3).toFixed(1)}K`:d.toLocaleString()}async function R(d){try{await t.claimAchievementReward(d)}catch{}}return S(()=>{t.fetchLeaderboard("power"),t.fetchNearbyRanks("power"),t.fetchAchievements(),t.fetchPlayerAchievements()}),(d,o)=>(r(),i("div",{class:"min-h-screen p-4 md:p-8 font-mono",style:A({backgroundImage:`url('${a.BG_DUNGEON}')`})},[o[9]||(o[9]=e("div",{class:"fixed inset-0 bg-slate-950/80 pointer-events-none z-0"},null,-1)),e("div",V,[e("header",D,[e("div",I,[o[1]||(o[1]=B('<div class="flex items-center gap-4"><div class="w-14 h-14 bg-amber-600 pixel-box-sm flex items-center justify-center"><span class="text-3xl">üèÜ</span></div><div><h1 class="text-2xl md:text-3xl font-bold text-amber-400 text-shadow-retro">HALL OF FAME</h1><p class="text-slate-400 text-sm">Prove your worth. Claim your glory.</p></div></div>',1)),h(t).userEntry?(r(),i("div",U,[o[0]||(o[0]=e("div",{class:"text-xs text-amber-400 uppercase"},"Your Rank",-1)),e("div",W,[e("span",Y,"#"+l(h(t).userRank),1),h(t).userEntry.trend==="up"?(r(),i("span",q,"‚Üë")):h(t).userEntry.trend==="down"?(r(),i("span",H,"‚Üì")):v("",!0)]),e("div",K,l(k(h(t).userEntry.score))+" pts",1)])):v("",!0)])]),e("div",X,[(r(!0),i(x,null,p(h(g),(s,u)=>(r(),i("button",{key:u,onClick:De=>L(u),class:_(["pixel-box-sm px-4 py-2 text-sm font-bold transition-all",c.value===u?"bg-amber-600 text-white border-amber-400":"bg-slate-800 text-slate-400 hover:bg-slate-700"])},[e("span",Q,l(s.icon),1),w(" "+l(s.name),1)],10,J))),128))]),e("div",Z,[e("div",ee,[e("div",te,[e("h2",se,[e("span",null,l(h(g)[c.value].icon),1),w(" "+l(h(g)[c.value].name)+" ",1),e("span",ae,"- "+l(h(g)[c.value].description),1)]),h(t).isLoading?(r(),i("div",ne,[...o[2]||(o[2]=[e("div",{class:"animate-spin text-3xl mb-2"},"‚öîÔ∏è",-1),e("p",{class:"text-amber-400 animate-pulse"},"Loading rankings...",-1)])])):(r(),i("div",oe,[(r(!0),i(x,null,p(h(t).topEntries,(s,u)=>(r(),i("div",{key:s.id,class:_(["pixel-box-sm p-3 flex items-center gap-4 transition-all",C(s,u)])},[e("div",re,[s.rank<=3?(r(),i("span",ie,l($(s.rank)),1)):(r(),i("span",le,"#"+l(s.rank),1))]),o[4]||(o[4]=e("div",{class:"w-10 h-10 pixel-box-sm bg-slate-800 flex items-center justify-center"},[e("span",{class:"text-xl"},"üéÆ")],-1)),e("div",ce,[e("div",de,l(s.username),1),e("div",he,[s.trend==="up"?(r(),i("span",me,"‚Üë Rising")):s.trend==="down"?(r(),i("span",ue,"‚Üì Falling")):(r(),i("span",xe,"‚Üí Stable"))])]),e("div",pe,[e("div",be,l(k(s.score)),1),o[3]||(o[3]=e("div",{class:"text-xs text-slate-500"},"points",-1))])],2))),128)),h(t).topEntries.length===0?(r(),i("div",fe,[...o[5]||(o[5]=[e("p",null,"No rankings available yet.",-1),e("p",{class:"text-sm"},"Be the first to climb the ranks!",-1)])])):v("",!0)]))]),h(t).nearbyRanks?.entries?.length?(r(),i("div",ve,[o[6]||(o[6]=e("h3",{class:"text-sm font-bold text-slate-400 mb-3 uppercase tracking-wider"},"Nearby Competition",-1)),e("div",_e,[(r(!0),i(x,null,p(h(t).nearbyRanks.entries,s=>(r(),i("div",{key:s.id,class:_(["pixel-box-sm p-2 flex items-center gap-3 text-sm",s.user_id===h(t).leaderboard?.user_entry?.user_id?"bg-amber-900/20 border-amber-500/30":"bg-slate-800/50"])},[e("span",{class:_(["w-8 text-center font-bold",s.rank===h(t).userRank?"text-amber-400":"text-slate-500"])}," #"+l(s.rank),3),e("span",ge,l(s.username),1),e("span",ye,l(k(s.score)),1)],2))),128))])])):v("",!0)]),e("div",ke,[e("div",we,[o[8]||(o[8]=e("h2",{class:"text-lg font-bold text-amber-400 mb-4 flex items-center gap-2"},[e("span",null,"‚≠ê"),w(" Achievements ")],-1)),e("div",Ae,[(r(!0),i(x,null,p(h(t).progressByCategory,(s,u)=>(r(),i("div",{key:u,class:"pixel-box-sm bg-slate-800/50 p-2"},[e("div",Ee,[e("span",Le,l(u),1),e("span",Ce,l(s.completed)+"/"+l(s.total),1)]),e("div",$e,[e("div",{class:"h-full bg-amber-500 transition-all",style:A({width:`${s.completed/s.total*100}%`})},null,4)])]))),128))]),e("div",Re,[(r(!0),i(x,null,p(m.value.slice(0,5),s=>(r(),i("div",{key:s.id,class:"pixel-box-sm p-3 bg-amber-900/20 border-amber-500/30 cursor-pointer hover:bg-amber-900/30 transition-colors",onClick:u=>R(s.achievement_id)},[e("div",Ne,[e("span",Se,l(s.achievement?.icon),1),e("div",Be,[e("div",je,l(s.achievement?.name),1),e("div",ze,l(s.achievement?.description),1),e("div",Pe,"Click to claim "+l(s.achievement?.reward_gold)+" gold!",1)])])],8,Fe))),128)),(r(!0),i(x,null,p(y.value.filter(s=>s.claimed).slice(0,5),s=>(r(),i("div",{key:s.id,class:"pixel-box-sm p-3 bg-slate-800/50 opacity-60"},[e("div",Ge,[e("span",Oe,l(s.achievement?.icon),1),e("div",Te,[e("div",Me,l(s.achievement?.name),1),e("div",Ve,l(s.achievement?.description),1)]),o[7]||(o[7]=e("span",{class:"text-green-500 text-xs"},"‚úì Claimed",-1))])]))),128))])])])])])],4))}});export{Ue as default};
